SET enable_indexscan = OFF;
SET enable_bitmapscan = OFF;
SET enable_indexonlyscan = OFF;

-- EXPLAIN (ANALYZE, BUFFERS OFF)
SELECT *
FROM name_basics
WHERE birth_year = 1990;

SET enable_indexscan = ON;
SET enable_bitmapscan = ON;
SET enable_indexonlyscan = ON;


=============

// 1000001 because with header
[System.IO.File]::ReadLines("C:\Users\RIVAL\Downloads\imdb dataset\name.basics.tsv") | Select-Object -First 1000001 | Set-Content name.basics.1m.tsv

=============
FIX LINE 677884 di title.basics.1m.tsv because:
COPY error: error: invalid input syntax for type boolean: "1996"
where: 'COPY title_basics, line 677884, column is_adult: "1996"',
solusi: buat fungsi escape value di migration script


============
i need to load all reviews to title_ratings_temp first and then only insert the review for tconst that exist in title_basics
CREATE TABLE title_ratings_temp (
    tconst TEXT PRIMARY KEY,
    average_rating REAL,
    num_votes INTEGER NOT NULL DEFAULT 0
);

// after COPY
INSERT INTO title_ratings 
    SELECT * FROM title_ratings_temp
    WHERE tconst IN (SELECT tconst FROM title_basics)
    ON CONFLICT (tconst) DO NOTHING